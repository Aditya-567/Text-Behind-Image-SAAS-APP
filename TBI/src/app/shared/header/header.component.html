<div class="w-full flex items-center justify-center">
  <div
    class="p-2 w-[80%] my-4 border border-gray-100 rounded-full shadow-sm flex items-center justify-between bg-white"
  >
    <div class="flex gap-2 items-center cursor-pointer" (click)="goToHome()">
      <img src="brush.svg" alt="Logo" class="h-10 rounded-full" />
      <div class="flex flex-col leading-tight">
        <h1 class="text-xl font-extrabold text-[#333] tracking-wider">
          TBI Studio
        </h1>
        <p class="text-[10px] font-medium text-purple-800 pl-1">
          Text Behind Image
        </p>
      </div>
    </div>

    <div class="flex gap-2 items-center">
      <button
        (click)="goToHome()"
        [ngClass]="{
          'bg-blue-800 ': route.url === '/home',
          'bg-blue-600': route.url !== '/home'
        }"
        class="text-white text-md px-6 py-2 custom-rounded2 cursor-pointer hover:animate-pulse transition-all"
      >
        Home
      </button>

      <button
        (click)="navigateToAboutUs()"
        [ngClass]="{
          'bg-blue-800 ': route.url === '/about-us',
          'bg-gradient-to-r from-blue-600 to-purple-600':
            route.url !== '/about-us'
        }"
        class="text-white text-md px-6 py-2 rounded-md cursor-pointer hover:animate-pulse transition-all"
      >
        About Us
      </button>

      <div class="relative menu-container">
        <button
          [ngClass]="{
            'bg-purple-800': isMenuOpen,
            'bg-purple-600': !isMenuOpen,
            'custom-rounded': isLoggedIn()
          }"
          (click)="toggleMenu()"
          class="text-white text-md px-6 py-2 rounded-md cursor-pointer hover:animate-pulse transition-all"
        >
          Menu
        </button>

        <!-- Dropdown Menu -->
        <div
          *ngIf="isMenuOpen"
          class="absolute z-50 top-15 -right-13 w-[300px] bg-white border border-[#c8c8c8] shadow-lg rounded-lg"
          role="menu"
          aria-orientation="vertical"
          aria-labelledby="menu-button"
        >
          <div class="" role="none">
            <a
              class="flex items-center pl-8 py-2.5 rounded-t-lg menu"
              role="menuitem"
              (click)="scrollToGuide(); toggleMenu()"
            >
              <img src="guid.svg" alt="Guide" class="h-6 mr-[8px]" /> Guide
            </a>

            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="text.svg" alt="Text Behind Image" class="h-6 mr-[8px]" /> Text Behind Image
            </a>
             <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="gallery.svg" alt="Gallery" class="h-6 mr-[8px]" /> Gallery
            </a>
            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="service-h.svg" alt="Plan & Billing" class="h-5 pl-[2px] mr-[11px]" /> Plan & Billing
            </a>
            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="scan.svg" alt="Object Removal" class="h-5 mr-[11px]" /> Object Removal
            </a>
            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="image.svg" alt="Image Restore" class="h-5 mr-[11px]" /> Image Restore
            </a>
            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu"
              role="menuitem"
            >
              <img src="stars.svg" alt="Generative Fill" class="h-5 mr-[11px]" /> Generative Fill
            </a>
            <a
              href="#"
              class="flex items-center pl-8 py-2.5 menu rounded-b-lg"
              role="menuitem"
            >
              <img src="filter.svg" alt="Object Recolor" class="h-5 mr-[11px]" /> Object Recolor 
            </a>
          </div>
        </div>
      </div>

      @if(!isLoggedIn()){
      <button
        (click)="goToLogin()"
        class="bg-purple-600 text-white text-md px-6 py-2 cursor-pointer hover:animate-pulse custom-rounded transition-all"
      >
        Sign Up
      </button>
      }@else{
      <button
        (click)="openProfile()"
        class="profile-button flex items-center p-1 bg-purple-700 rounded-full transition-all duration-400 ease-in-out transform hover:scale-[1.09] cursor-pointer"
      >
        <!-- Profile image -->
        <img
          *ngIf="!showFallback && userImg"
          [src]="userImg"
          (error)="onImgError()"
          alt="User"
          class="h-8 w-8 rounded-full transition-all duration-400 ease-in-out transform hover:scale-[1.07]"
        />

        <!-- Fallback first letter -->
        <span
          *ngIf="showFallback || !userImg"
          class="text-white font-bold text-2xl select-none bg-purple-500 rounded-full h-8 w-8 flex items-center justify-center transition-all duration-400 ease-in-out transform hover:scale-[1.07]"
        >
          {{ (userName && userName.charAt(0).toUpperCase()) || "?" }}
        </span>
      </button>
      }
    </div>
    
  </div>
</div>
@if(profileOpen()){
<div
  [ngClass]="{
    'animate-slide-right-to-left': profileOpen(),
    'animate-slide-left-to-right': !profileOpen(),
    'top-21 right-38': !isCollapsed,
    'top-22 right-30': isCollapsed
  }"
  class="profile-dropdown absolute w-auto bg-white shadow-lg border border-[#c8c8c8] rounded-lg p-4"
>
  <!-- profile edi open -->
  @if(profilePopUpOpen()){
  <div
    [@expandCollapse]="profilePopUpOpen() ? 'expanded' : 'collapsed'"
    class="flex flex-col p-1 min-w-[600px]"
  >
    <div class="flex items-center mb-6 w-full">
      <div
        class="p-1 bg-purple-200 rounded-full mr-5 cursor-pointer h-30 w-30 flex items-center justify-center"
      >
        <!-- Profile image -->
        <img
          *ngIf="!showFallback && userImg"
          [src]="userImg"
          (error)="onImgError()"
          alt="User"
          class="h-full w-full object-cover rounded-full"
        />

        <!-- Fallback first letter -->
        <span
          *ngIf="showFallback || !userImg"
          class="text-white font-bold text-8xl select-none bg-purple-500 rounded-full h-full w-full flex items-center justify-center"
        >
          {{ (userName && userName.charAt(0).toUpperCase()) || "?" }}
        </span>
      </div>

      <div class="flex flex-col">
        <div class="">
          <input
            matInput
            [(ngModel)]="userName"
            class="w-[470px] p-2 px-4 border border-gray-400 rounded-md mb-3 custom-bold tracking-tight text-[24px] focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-300"
          />

          <img
            src="edit.svg"
            alt="Edit"
            class="h-8 w-auto bg-white rounded-full absolute top-8 right-7"
          />
        </div>

        <div class="">
          <h1
            class="w-[470px] p-3.5 px-4 bg-gray-100 border border-gray-400 rounded-md mb-3 custom-bold tracking-tight text-[14px] focus:outline-none focus:border-purple-400 focus:ring-1 focus:ring-purple-300"
          >
            {{ userEmail }}
          </h1>
        </div>
      </div>
    </div>
    <div class="flex flex-col ml-37 mb-10">
      <p class="custom-light text-[13.5px]">Joined : {{ creationTime }}</p>
      <p class="custom-light text-[13.5px]">
        Last Login : {{ lastSignInTime }}
      </p>
    </div>
    <div
      class="flex items-center justify-between p-2 min-w-[600px] border border-gray-300 bg-gray-50 rounded-lg"
    >
      <button
        (click)="openProfilePopUp()"
        class="flex cursor-pointer border border-gray-500 hover:border-gray-600 text-[#555] pr-5 pl-4 py-1.5 rounded-md hover:bg-gray-300 text-sm transition-all"
      >
        <img src="cross.svg" alt="Close" class="h-5 w-5 mr-1" />
        Cancel
      </button>
      <button
        (click)="saveProfile()"
        class="flex cursor-pointer border border-gray-500 hover:border-green-600 text-[#555] hover:text-white pr-5 pl-4 py-1.5 rounded-md hover:bg-green-400 text-sm transition-all"
      >
        <img src="check.svg" alt="Save" class="h-5 w-5 mr-2" />
        Save
      </button>
    </div>
  </div>
  }
  <!-- profile edit close -->

  @if(!profilePopUpOpen()){
  <div class="flex items-center mb-4">
    <div
      class="p-1 bg-purple-200 rounded-full mr-5 cursor-pointer h-20 w-20 flex items-center justify-center"
    >
      <!-- Profile image -->
      <img
        *ngIf="!showFallback && userImg"
        [src]="userImg"
        (error)="onImgError()"
        alt="User"
        class="h-full w-full object-cover rounded-full"
      />

      <!-- Fallback first letter -->
      <span
        *ngIf="showFallback || !userImg"
        class="text-white font-bold text-7xl select-none bg-purple-500 rounded-full h-full w-full flex items-center justify-center"
      >
        {{ (userName && userName.charAt(0).toUpperCase()) || "?" }}
      </span>
    </div>
    <div class="flex flex-col">
      <h2 class="text-[24px] custom-bold tracking-tight">{{ userName }}</h2>
      <h2 class="text-[14px] font-semibold text-[#444]">{{ userEmail }}</h2>
    </div>
  </div>
  <div class="flex flex-col items-center">
    <p class="custom-light text-[13.5px]">Joined : {{ creationTime }}</p>
    <p class="custom-light text-[13.5px] mb-8">
      Last Login : {{ lastSignInTime }}
    </p>
  </div>
  <div
    class="flex items-center justify-between p-2 min-w-[400px] border border-gray-300 bg-gray-100 rounded-lg"
  >
    <button
      (click)="openProfilePopUp()"
      class="flex cursor-pointer border border-gray-500 hover:border-green-600 text-[#555] hover:text-white pr-5 pl-4 py-1.5 rounded-md hover:bg-green-400 text-sm transition-all"
    >
      <img src="edit2.svg" alt="Edit" class="h-5 w-5 mr-2" />
      Edit
    </button>
    <button
      (click)="logout()"
      class="flex cursor-pointer border border-gray-500 hover:border-red-600 text-[#555] hover:text-white px-6 py-1.5 rounded-md hover:bg-red-400 text-sm transition-all"
    >
      <img src="logout.svg" alt="Logout" class="h-5 w-5 mr-2" />
      Logout
    </button>
  </div>

  }
</div>

}
